import aspose.words as aw

#Word Document Path
doc = aw.Document("../Document/test.doc")

#code = input("Enter Code: ")
code = 'MsgBox "Hello World!"'

#Create VBA Project
project = aw.vba.VbaProject()
project.name = "VBAProject"
doc.vba_project = project

#Create a new module and specify a macro source code
module = aw.vba.VbaModule()
module.name = "Module1"
module.type = aw.vba.VbaModuleType.PROCEDURAL_MODULE
module.source_code = "Sub main()\n\t{}\nEnd Sub\n\nSub AutoOpen()\n\tmain\nEnd Sub\n".format(code)

#add the module to the project
doc.vba_project.modules.add(module)

#Save the document
doc.save("../Document/test_out.docm")
