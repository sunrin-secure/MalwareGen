import aspose.words as aw

global doc

def document(path):
    global doc
    
    #Word Document Path
    doc = aw.Document("../Document/"+path)
    
    #Create VBA Project
    project = aw.vba.VbaProject()
    project.name = "VBAProject"
    doc.vba_project = project

def insertmacro(code):
    global doc
    
    #Create a new module and specify a macro source code
    module = aw.vba.VbaModule()
    module.name = "Module1"
    module.type = aw.vba.VbaModuleType.PROCEDURAL_MODULE
    module.source_code = "Sub AutoOpen()\n\tmain\nEnd Sub\nSub main()\n\t{}\nEnd Sub\n".format(code)

    #add the module to the project
    doc.vba_project.modules.add(module)

def save(path):
    global doc
    #Save the document
    doc.save(path)
